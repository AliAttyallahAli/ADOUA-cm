(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,58678,(e,t,s)=>{t.exports=e.r(80963)},72973,e=>{"use strict";e.s(["default",()=>L],72973);var t=e.i(91398),s=e.i(91788),r=e.i(3828),a=e.i(58678);function l(e){let{activeTab:r,setActiveTab:a,sidebarOpen:l,setSidebarOpen:n,user:i}=e,o=[{id:"overview",label:"Aper√ßu",icon:"üìä",roles:["admin","chef_operation","caissier","agent"]},{id:"clients",label:"Clients",icon:"üë•",roles:["admin","chef_operation","caissier","agent"]},{id:"transactions",label:"Transactions",icon:"üîÑ",roles:["admin","chef_operation","caissier","agent"]},{id:"loans",label:"Pr√™ts",icon:"üí∞",roles:["admin","chef_operation","caissier"]},{id:"users",label:"Utilisateurs",icon:"üë®‚Äçüíº",roles:["admin","chef_operation"]},{id:"documents",label:"Documents",icon:"üé´",roles:["admin","chef_operation","caissier","agent"]}].filter(e=>e.roles.includes(i.role));return(0,s.useEffect)(()=>{let e=e=>{a(e.detail)};return window.addEventListener("tabChange",e),()=>window.removeEventListener("tabChange",e)},[a]),(0,t.jsxs)(t.Fragment,{children:[l&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-20 lg:hidden",onClick:()=>n(!1)}),(0,t.jsxs)("div",{className:"\n        fixed inset-y-0 left-0 z-30 w-64 bg-white shadow-xl transform transition-transform duration-300 ease-in-out lg:translate-x-0 lg:static lg:inset-0\n        ".concat(l?"translate-x-0":"-translate-x-full","\n      "),children:[(0,t.jsx)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-600 to-purple-700 rounded-xl flex items-center justify-center text-white font-bold",children:"AM"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-xl font-bold text-gray-800",children:"ADOUAS-MC"}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Micro Cr√©dit"})]})]})}),(0,t.jsx)("nav",{className:"p-4 space-y-2",children:o.map(e=>(0,t.jsxs)("button",{onClick:()=>{a(e.id),n(!1)},className:"\n                w-full flex items-center space-x-3 px-4 py-3 rounded-xl text-left transition-all duration-200\n                ".concat(r===e.id?"bg-blue-50 text-blue-600 border border-blue-200":"text-gray-600 hover:bg-gray-50 hover:text-gray-900","\n              "),children:[(0,t.jsx)("span",{className:"text-xl",children:e.icon}),(0,t.jsx)("span",{className:"font-medium",children:e.label})]},e.id))}),(0,t.jsx)("div",{className:"absolute bottom-0 left-0 right-0 p-4 border-t border-gray-200 bg-white",children:(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-green-500 to-blue-600 rounded-full flex items-center justify-center text-white font-bold",children:i.name.charAt(0)}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:i.name}),(0,t.jsx)("p",{className:"text-xs text-gray-500 capitalize",children:i.role.replace("_"," ")})]})]})})]})]})}function n(e){let{user:s,onLogout:r,onMenuClick:a}=e;return(0,t.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200 z-10",children:(0,t.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 sm:px-6",children:[(0,t.jsx)("button",{onClick:a,className:"lg:hidden p-2 rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-100 transition-colors",children:(0,t.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),(0,t.jsx)("div",{className:"flex-1 max-w-lg mx-4",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:"text",placeholder:"Rechercher clients, transactions...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),(0,t.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,t.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)("button",{className:"p-2 text-gray-600 hover:text-gray-900 relative",children:[(0,t.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-5 5v-5zM10.5 3.75a6 6 0 0 0-6 6v2.25l-2.47 2.47a.75.75 0 0 0 .53 1.28h15.88a.75.75 0 0 0 .53-1.28L16.5 12V9.75a6 6 0 0 0-6-6z"})}),(0,t.jsx)("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"})]}),(0,t.jsxs)("div",{className:"relative group",children:[(0,t.jsxs)("button",{className:"flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-100 transition-colors",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-green-500 to-blue-600 rounded-full flex items-center justify-center text-white font-bold text-sm",children:s.name.charAt(0)}),(0,t.jsxs)("div",{className:"hidden sm:block text-left",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900",children:s.name}),(0,t.jsx)("p",{className:"text-xs text-gray-500 capitalize",children:s.role.replace("_"," ")})]})]}),(0,t.jsx)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200",children:(0,t.jsxs)("div",{className:"p-2",children:[(0,t.jsx)("button",{className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-md",children:"Mon profil"}),(0,t.jsx)("button",{className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-md",children:"Param√®tres"}),(0,t.jsx)("button",{onClick:r,className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 rounded-md",children:"D√©connexion"})]})})]})]})]})})}function i(e){let{stats:r}=e,[a,l]=(0,s.useState)([]);return((0,s.useEffect)(()=>{var e,t,s;l([{title:"Solde Principal",value:"1,000,000,000 XOF",change:"+2.5%",trend:"up",icon:"üí∞",color:"green"},{title:"Transactions en attente",value:(null==r||null==(e=r.pendingTransactions)?void 0:e.toString())||"12",change:"+3",trend:"up",icon:"‚è≥",color:"yellow"},{title:"Pr√™ts Actifs",value:(null==r||null==(t=r.activeLoans)?void 0:t.toString())||"45",change:"+5%",trend:"up",icon:"üìä",color:"blue"},{title:"Clients Totals",value:(null==r||null==(s=r.totalClients)?void 0:s.toString())||"128",change:"+8",trend:"up",icon:"üë•",color:"purple"}])},[r]),Array.isArray(a))?(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:a.map((e,s)=>(0,t.jsxs)("div",{className:"".concat((e=>{let t={green:"bg-gradient-to-br from-green-50 to-green-100 border-green-200",yellow:"bg-gradient-to-br from-yellow-50 to-yellow-100 border-yellow-200",blue:"bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",purple:"bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200"};return t[e]||t.blue})(e.color)," rounded-2xl border-2 p-6 transition-transform hover:scale-105 duration-200"),children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-600 mb-1",children:e.title}),(0,t.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:"string"==typeof e.value?e.value:JSON.stringify(e.value)})]}),(0,t.jsx)("div",{className:"text-3xl",children:e.icon})]}),(0,t.jsxs)("div",{className:"flex items-center text-sm font-medium ".concat("up"===e.trend?"text-green-600":"text-red-600"),children:[(0,t.jsx)("span",{children:e.change}),(0,t.jsx)("span",{className:"ml-1",children:"ce mois"})]})]},s))}):(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[1,2,3,4].map(e=>(0,t.jsxs)("div",{className:"bg-gray-100 rounded-2xl p-6 animate-pulse",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-300 rounded w-3/4 mb-2"}),(0,t.jsx)("div",{className:"h-6 bg-gray-300 rounded w-1/2"})]},e))})}function o(e){let{transactions:s}=e,r=Array.isArray(s)?s:[];return 0===r.length?(0,t.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,t.jsx)("div",{className:"text-4xl mb-2",children:"üìù"}),(0,t.jsx)("p",{children:"Aucune transaction r√©cente"})]}):(0,t.jsx)("div",{className:"space-y-4",children:r.slice(0,5).map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("div",{className:"text-2xl",children:{transfert:"üîÑ",pret:"üí∞",remboursement:"üì•",depot:"üí≥"}[e.type]||"‚ö°"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-gray-900 capitalize",children:e.type||"Transaction"}),(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:["De ",(e.from_wallet||"").slice(0,8),"..."]})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("p",{className:"font-semibold text-gray-900",children:[parseFloat(e.amount||0).toLocaleString()," XOF"]}),(0,t.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat((e=>{let t={completed:"bg-green-100 text-green-800",pending:"bg-yellow-100 text-yellow-800",cancelled:"bg-red-100 text-red-800"};return t[e]||t.pending})(e.status)),children:"completed"===e.status?"Compl√©t√©":"pending"===e.status?"En attente":"Annul√©"})]})]},e.id))})}function c(e){let{user:r}=e,[a,l]=(0,s.useState)([]),[n,i]=(0,s.useState)([]),[o,c]=(0,s.useState)(!1),[m,u]=(0,s.useState)(null);(0,s.useEffect)(()=>{h(),p()},[]);let h=async()=>{let e=localStorage.getItem("token");try{let t=await fetch("/api/loans",{headers:{Authorization:"Bearer ".concat(e)}}),s=await t.json();l(s)}catch(e){console.error("Erreur:",e)}},p=async()=>{let e=localStorage.getItem("token");try{let t=await fetch("/api/clients",{headers:{Authorization:"Bearer ".concat(e)}}),s=await t.json();i(s)}catch(e){console.error("Erreur:",e)}},g=async(e,t)=>{let s=localStorage.getItem("token");try{let r=await fetch("/api/loans/".concat(e,"/repayment"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify({amount:parseFloat(t)})});if(r.ok)h(),u(null),alert("Remboursement effectu√© avec succ√®s");else{let e=await r.json();alert(e.error)}}catch(e){console.error("Erreur:",e)}};return(0,t.jsxs)("div",{className:"px-4 py-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold",children:"Gestion des Pr√™ts"}),("admin"===r.role||"chef_operation"===r.role)&&(0,t.jsx)("button",{onClick:()=>c(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:"Nouveau Pr√™t"})]}),o&&(0,t.jsx)(d,{clients:n,onClose:()=>c(!1),onSuccess:h}),m&&(0,t.jsx)(x,{loan:m,onClose:()=>u(null),onRepayment:g}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[(0,t.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-600",children:"Pr√™ts Actifs"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-blue-600",children:a.filter(e=>"active"===e.status).length})]}),(0,t.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-600",children:"Montant Total Pr√™ts"}),(0,t.jsxs)("p",{className:"text-3xl font-bold text-green-600",children:[a.reduce((e,t)=>e+parseFloat(t.amount),0).toLocaleString()," XOF"]})]}),(0,t.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-600",children:"Montant √† R√©cup√©rer"}),(0,t.jsxs)("p",{className:"text-3xl font-bold text-orange-600",children:[a.reduce((e,t)=>e+parseFloat(t.remaining_amount),0).toLocaleString()," XOF"]})]})]}),(0,t.jsx)("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Client"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Montant"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Taux"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Total"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Pay√©"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Reste"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Statut"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.client_name}),(0,t.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[parseFloat(e.amount).toLocaleString()," XOF"]}),(0,t.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[e.interest_rate,"%"]}),(0,t.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[parseFloat(e.total_amount).toLocaleString()," XOF"]}),(0,t.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-600",children:[parseFloat(e.paid_amount).toLocaleString()," XOF"]}),(0,t.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-red-600",children:[parseFloat(e.remaining_amount).toLocaleString()," XOF"]}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat("active"===e.status?"bg-green-100 text-green-800":"completed"===e.status?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:e.status})}),(0,t.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:["active"===e.status&&(0,t.jsx)("button",{onClick:()=>u(e),className:"text-green-600 hover:text-green-900 mr-3",children:"Rembourser"}),(0,t.jsx)("button",{className:"text-blue-600 hover:text-blue-900",children:"D√©tails"})]})]},e.id))})]})})]})}function d(e){let{clients:r,onClose:a,onSuccess:l}=e,[n,i]=(0,s.useState)({client_id:"",amount:"",interest_rate:"10",duration:"12"}),o=async e=>{e.preventDefault();let t=localStorage.getItem("token");try{let e=await fetch("/api/loans",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({...n,amount:parseFloat(n.amount),interest_rate:parseFloat(n.interest_rate),duration:parseInt(n.duration)})});if(e.ok)l(),a();else{let t=await e.json();alert(t.error)}}catch(e){console.error("Erreur:",e),alert("Erreur lors de la cr√©ation du pr√™t")}},c=n.amount?(parseFloat(n.amount)*(1+parseFloat(n.interest_rate)/100)).toFixed(2):0;return(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,t.jsx)("h3",{className:"text-lg font-bold mb-4",children:"Nouveau Pr√™t"}),(0,t.jsxs)("form",{onSubmit:o,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Client"}),(0,t.jsxs)("select",{value:n.client_id,onChange:e=>i({...n,client_id:e.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md",required:!0,children:[(0,t.jsx)("option",{value:"",children:"S√©lectionner un client"}),r.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.name," - ",e.wallet_address]},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Montant du pr√™t (XOF)"}),(0,t.jsx)("input",{type:"number",step:"0.01",value:n.amount,onChange:e=>i({...n,amount:e.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Taux d'int√©r√™t (%)"}),(0,t.jsx)("select",{value:n.interest_rate,onChange:e=>i({...n,interest_rate:e.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md",children:Array.from({length:20},(e,t)=>t+1).map(e=>(0,t.jsxs)("option",{value:e,children:[e,"%"]},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Dur√©e (mois)"}),(0,t.jsxs)("select",{value:n.duration,onChange:e=>i({...n,duration:e.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,t.jsx)("option",{value:"6",children:"6 mois"}),(0,t.jsx)("option",{value:"12",children:"12 mois"}),(0,t.jsx)("option",{value:"24",children:"24 mois"}),(0,t.jsx)("option",{value:"36",children:"36 mois"})]})]}),(0,t.jsxs)("div",{className:"bg-gray-50 p-3 rounded-md",children:[(0,t.jsx)("h4",{className:"font-semibold mb-2",children:"R√©capitulatif"}),(0,t.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Montant initial:"}),(0,t.jsxs)("span",{children:[n.amount||0," XOF"]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsxs)("span",{children:["Int√©r√™ts (",n.interest_rate,"%):"]}),(0,t.jsxs)("span",{children:[n.amount*n.interest_rate/100||0," XOF"]})]}),(0,t.jsxs)("div",{className:"flex justify-between font-semibold border-t pt-1",children:[(0,t.jsx)("span",{children:"Total √† rembourser:"}),(0,t.jsxs)("span",{className:"text-green-600",children:[c," XOF"]})]}),(0,t.jsxs)("div",{className:"flex justify-between text-xs text-gray-500",children:[(0,t.jsx)("span",{children:"Mensualit√© estim√©e:"}),(0,t.jsxs)("span",{children:[(c/n.duration).toFixed(2)," XOF/mois"]})]})]})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,t.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Annuler"}),(0,t.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Cr√©er le Pr√™t"})]})]})]})})}function x(e){let{loan:r,onClose:a,onRepayment:l}=e,[n,i]=(0,s.useState)("");return(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,t.jsx)("h3",{className:"text-lg font-bold mb-4",children:"Remboursement de Pr√™t"}),(0,t.jsxs)("p",{className:"text-sm text-gray-600 mb-4",children:["Client: ",(0,t.jsx)("strong",{children:r.client_name}),(0,t.jsx)("br",{}),"Reste √† payer: ",(0,t.jsxs)("strong",{children:[parseFloat(r.remaining_amount).toLocaleString()," XOF"]})]}),(0,t.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),parseFloat(n)>parseFloat(r.remaining_amount))return void alert("Le montant ne peut pas d√©passer le reste √† payer");l(r.id,n)},className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Montant du remboursement (XOF)"}),(0,t.jsx)("input",{type:"number",step:"0.01",max:r.remaining_amount,value:n,onChange:e=>i(e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md",required:!0}),(0,t.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Int√©r√™ts pour cette transaction: ",(n*r.interest_rate/100).toFixed(2)," XOF"]})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,t.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Annuler"}),(0,t.jsx)("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:"Effectuer le Remboursement"})]})]})]})})}function m(e){let{onClose:r,onSuccess:a}=e,[l,n]=(0,s.useState)({from_wallet:"",to_wallet:"",amount:"",type:"transfert",description:"",interest_rate:0}),[i,o]=(0,s.useState)([]),[c,d]=(0,s.useState)([]),[x,m]=(0,s.useState)(!1);(0,s.useEffect)(()=>{u(),h()},[]);let u=async()=>{let e=localStorage.getItem("token");try{let t=await fetch("/api/clients",{headers:{Authorization:"Bearer ".concat(e)}}),s=await t.json();o(s)}catch(e){console.error("Erreur:",e)}},h=async()=>{let e=localStorage.getItem("token");try{let t=await fetch("/api/user/wallets",{headers:{Authorization:"Bearer ".concat(e)}}),s=await t.json();d(s)}catch(e){console.error("Erreur:",e)}},p=async e=>{e.preventDefault(),m(!0);let t=localStorage.getItem("token");try{let e=await fetch("/api/transactions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(l)});if(e.ok)a();else{let t=await e.json();alert(t.error)}}catch(e){console.error("Erreur:",e),alert("Erreur lors de la cr√©ation de la transaction")}finally{m(!1)}};return(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Nouvelle Transaction"}),(0,t.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,t.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,t.jsxs)("form",{onSubmit:p,className:"p-6 space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Type de Transaction"}),(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:[{value:"transfert",label:"Transfert",icon:"üîÑ"},{value:"pret",label:"Pr√™t",icon:"üí∞"},{value:"remboursement",label:"Remboursement",icon:"üì•"},{value:"depot",label:"D√©p√¥t",icon:"üí≥"},{value:"retrait",label:"Retrait",icon:"üèß"}].map(e=>(0,t.jsxs)("button",{type:"button",onClick:()=>n({...l,type:e.value}),className:"p-3 rounded-xl border-2 transition-all ".concat(l.type===e.value?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-gray-300 text-gray-600"),children:[(0,t.jsx)("div",{className:"text-2xl mb-1",children:e.icon}),(0,t.jsx)("div",{className:"text-xs font-medium",children:e.label})]},e.value))})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Exp√©diteur"}),(0,t.jsxs)("select",{value:l.from_wallet,onChange:e=>n({...l,from_wallet:e.target.value}),className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[(0,t.jsx)("option",{value:"",children:"S√©lectionner un wallet"}),(0,t.jsx)("optgroup",{label:"Vos Wallets",children:c.map(e=>(0,t.jsxs)("option",{value:e.address,children:[e.address," - ",e.balance," XOF"]},e.address))}),(0,t.jsx)("optgroup",{label:"Clients",children:i.map(e=>(0,t.jsxs)("option",{value:e.wallet_address,children:[e.name," - ",e.wallet_address]},e.wallet_address))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Destinataire"}),(0,t.jsxs)("select",{value:l.to_wallet,onChange:e=>n({...l,to_wallet:e.target.value}),className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[(0,t.jsx)("option",{value:"",children:"S√©lectionner un wallet"}),(0,t.jsx)("optgroup",{label:"Clients",children:i.map(e=>(0,t.jsxs)("option",{value:e.wallet_address,children:[e.name," - ",e.wallet_address]},e.wallet_address))}),(0,t.jsx)("optgroup",{label:"Vos Wallets",children:c.map(e=>(0,t.jsxs)("option",{value:e.address,children:[e.address," - ",e.balance," XOF"]},e.address))})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Montant (XOF)"}),(0,t.jsx)("input",{type:"number",step:"0.01",min:"0",value:l.amount,onChange:e=>n({...l,amount:e.target.value}),className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0.00",required:!0})]}),("pret"===l.type||"remboursement"===l.type)&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Taux d'int√©r√™t (%)"}),(0,t.jsx)("input",{type:"number",step:"0.1",min:"0",max:"20",value:l.interest_rate,onChange:e=>n({...l,interest_rate:e.target.value}),className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0.0"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,t.jsx)("textarea",{value:l.description,onChange:e=>n({...l,description:e.target.value}),rows:"3",className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Description de la transaction..."})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[(0,t.jsx)("button",{type:"button",onClick:r,className:"px-6 py-3 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:"Annuler"}),(0,t.jsxs)("button",{type:"submit",disabled:x,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[x&&(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,t.jsx)("span",{children:"Cr√©er la Transaction"})]})]})]})]})})}function u(e){let{onClose:r,onSuccess:a}=e,[l,n]=(0,s.useState)({name:"",email:"",phone:"",address:"",cin:""}),[i,o]=(0,s.useState)(!1),c=async e=>{e.preventDefault(),o(!0);let t=localStorage.getItem("token");try{let e=await fetch("/api/clients",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(l)});if(e.ok)a();else{let t=await e.json();alert(t.error)}}catch(e){console.error("Erreur:",e),alert("Erreur lors de la cr√©ation du client")}finally{o(!1)}};return(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-2xl",children:[(0,t.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Nouveau Client"}),(0,t.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,t.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,t.jsxs)("form",{onSubmit:c,className:"p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom Complet *"}),(0,t.jsx)("input",{type:"text",value:l.name,onChange:e=>n({...l,name:e.target.value}),className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"John Doe",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),(0,t.jsx)("input",{type:"email",value:l.email,onChange:e=>n({...l,email:e.target.value}),className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"john@example.com",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"T√©l√©phone *"}),(0,t.jsx)("input",{type:"tel",value:l.phone,onChange:e=>n({...l,phone:e.target.value}),className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"+221 XX XXX XX XX",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CIN *"}),(0,t.jsx)("input",{type:"text",value:l.cin,onChange:e=>n({...l,cin:e.target.value}),className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"1234567890",required:!0})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Adresse"}),(0,t.jsx)("textarea",{value:l.address,onChange:e=>n({...l,address:e.target.value}),rows:"3",className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Adresse compl√®te du client..."})]}),(0,t.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[(0,t.jsx)("h4",{className:"font-semibold text-blue-900 mb-2",children:"Informations Syst√®me"}),(0,t.jsx)("p",{className:"text-sm text-blue-700",children:"Un wallet avec 5,000 XOF sera automatiquement cr√©√© pour ce client. L'adresse du wallet sera g√©n√©r√©e automatiquement."})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[(0,t.jsx)("button",{type:"button",onClick:r,className:"px-6 py-3 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:"Annuler"}),(0,t.jsxs)("button",{type:"submit",disabled:i,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[i&&(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,t.jsx)("span",{children:"Cr√©er le Client"})]})]})]})]})})}function h(e){let{client:r,onClose:a,onUpdate:l,user:n}=e,[i,o]=(0,s.useState)("info"),[c,d]=(0,s.useState)([]),[x,m]=(0,s.useState)([]),[u,h]=(0,s.useState)(0);(0,s.useEffect)(()=>{f()},[r.id]);let f=async()=>{let e=localStorage.getItem("token");try{let t=await fetch("/api/clients/".concat(r.id,"/loans"),{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();d(e)}}catch(e){console.error("Erreur:",e)}try{let t=await fetch("/api/clients/".concat(r.id,"/transactions"),{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();m(e)}}catch(e){console.error("Erreur:",e)}try{let t=await fetch("/api/wallets/".concat(r.wallet_address),{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();h(e.balance)}}catch(e){console.error("Erreur:",e)}},y=async()=>{let e=localStorage.getItem("token");try{let t=await fetch("/api/generate-card/".concat(r.id),{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.blob(),s=window.URL.createObjectURL(e),a=document.createElement("a");a.href=s,a.download="carte_visa_".concat(r.name,".pdf"),document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(s)}}catch(e){console.error("Erreur:",e)}};return c.reduce((e,t)=>e+parseFloat(t.amount),0),c.reduce((e,t)=>e+parseFloat(t.paid_amount),0),c.reduce((e,t)=>e+parseFloat(t.remaining_amount),0),(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[(0,t.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[r.photo?(0,t.jsx)("img",{src:r.photo,alt:r.name,className:"w-16 h-16 rounded-full object-cover"}):(0,t.jsx)("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold text-2xl",children:r.name.charAt(0)}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:r.name}),(0,t.jsx)("p",{className:"text-gray-600",children:r.email})]})]}),(0,t.jsx)("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,t.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,t.jsx)("div",{className:"border-b border-gray-200",children:(0,t.jsx)("nav",{className:"flex space-x-8 px-6",children:["info","prets","transactions","wallet"].map(e=>(0,t.jsxs)("button",{onClick:()=>o(e),className:"py-4 px-1 border-b-2 font-medium text-sm transition-colors ".concat(i===e?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"),children:["info"===e&&"Informations","prets"===e&&"Pr√™ts (".concat(c.length,")"),"transactions"===e&&"Transactions (".concat(x.length,")"),"wallet"===e&&"Portefeuille"]},e))})}),(0,t.jsxs)("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:["info"===i&&(0,t.jsx)(p,{client:r}),"prets"===i&&(0,t.jsx)(g,{loans:c}),"transactions"===i&&(0,t.jsx)(b,{transactions:x}),"wallet"===i&&(0,t.jsx)(j,{client:r,balance:u,onGenerateCard:y})]}),(0,t.jsx)("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:["Client depuis ",new Date(r.created_at).toLocaleDateString()]}),(0,t.jsxs)("div",{className:"flex space-x-3",children:[(0,t.jsxs)("button",{onClick:y,className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors font-medium flex items-center space-x-2",children:[(0,t.jsx)("span",{children:"üé´"}),(0,t.jsx)("span",{children:"G√©n√©rer Carte"})]}),("admin"===n.role||"chef_operation"===n.role)&&(0,t.jsx)("button",{className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"Modifier"})]})]})})]})})}function p(e){let{client:s}=e;return(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsx)("div",{className:"space-y-6",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations Personnelles"}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)(f,{label:"Nom Complet",value:s.name}),(0,t.jsx)(f,{label:"Email",value:s.email}),(0,t.jsx)(f,{label:"T√©l√©phone",value:s.phone}),(0,t.jsx)(f,{label:"CIN",value:s.cin})]})]})}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Adresse"}),(0,t.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,t.jsx)("p",{className:"text-gray-700",children:s.address||"Aucune adresse renseign√©e"})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Wallet"}),(0,t.jsx)("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:(0,t.jsx)("p",{className:"font-mono text-sm text-blue-800 break-all",children:s.wallet_address})})]})]})]})}function g(e){let{loans:s}=e;return 0===s.length?(0,t.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,t.jsx)("div",{className:"text-4xl mb-2",children:"üí∞"}),(0,t.jsx)("p",{children:"Aucun pr√™t pour ce client"})]}):(0,t.jsx)("div",{className:"space-y-4",children:s.map(e=>(0,t.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h4",{className:"font-semibold text-gray-900",children:["Pr√™t #",e.id]}),(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:["Cr√©√© le ",new Date(e.start_date).toLocaleDateString()]})]}),(0,t.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat("active"===e.status?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:"active"===e.status?"Actif":"Termin√©"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-500",children:"Montant initial"}),(0,t.jsxs)("p",{className:"font-semibold",children:[parseFloat(e.amount).toLocaleString()," XOF"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-500",children:"Taux d'int√©r√™t"}),(0,t.jsxs)("p",{className:"font-semibold",children:[e.interest_rate,"%"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-500",children:"Pay√©"}),(0,t.jsxs)("p",{className:"font-semibold text-green-600",children:[parseFloat(e.paid_amount).toLocaleString()," XOF"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-500",children:"Reste"}),(0,t.jsxs)("p",{className:"font-semibold text-orange-600",children:[parseFloat(e.remaining_amount).toLocaleString()," XOF"]})]})]}),(0,t.jsxs)("div",{className:"mt-3",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[(0,t.jsx)("span",{children:"Progression"}),(0,t.jsxs)("span",{children:[Math.round(e.paid_amount/e.total_amount*100),"%"]})]}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,t.jsx)("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(e.paid_amount/e.total_amount*100,"%")}})})]})]},e.id))})}function b(e){let{transactions:s}=e;return 0===s.length?(0,t.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,t.jsx)("div",{className:"text-4xl mb-2",children:"üîÑ"}),(0,t.jsx)("p",{children:"Aucune transaction pour ce client"})]}):(0,t.jsx)("div",{className:"space-y-3",children:s.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center ".concat("depot"===e.type?"bg-green-100 text-green-600":"retrait"===e.type?"bg-red-100 text-red-600":"bg-blue-100 text-blue-600"),children:"depot"===e.type?"üì•":"retrait"===e.type?"üì§":"üîÑ"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-gray-900 capitalize",children:e.type}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString()})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("p",{className:"font-semibold ".concat("depot"===e.type?"text-green-600":"text-red-600"),children:["depot"===e.type?"+":"-",parseFloat(e.amount).toLocaleString()," XOF"]}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:e.status})]})]},e.id))})}function j(e){let{client:s,balance:r,onGenerateCard:a}=e;return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-purple-700 rounded-2xl p-6 text-white",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-blue-200 text-sm",children:"ADOUAS-MC VISA"}),(0,t.jsx)("p",{className:"text-2xl font-bold mt-2",children:s.name.toUpperCase()})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("p",{className:"text-blue-200 text-sm",children:"Solde"}),(0,t.jsxs)("p",{className:"text-2xl font-bold",children:[r.toLocaleString()," XOF"]})]})]}),(0,t.jsxs)("div",{className:"flex justify-between items-end",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-blue-200 text-sm mb-1",children:"Num√©ro de compte"}),(0,t.jsx)("p",{className:"font-mono text-lg",children:s.wallet_address})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("p",{className:"text-blue-200 text-sm",children:"Valide jusqu'au"}),(0,t.jsx)("p",{className:"text-lg font-semibold",children:"12/25"})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("button",{onClick:a,className:"bg-white border-2 border-green-200 rounded-xl p-4 text-center hover:border-green-300 transition-colors group",children:[(0,t.jsx)("div",{className:"text-3xl mb-2 group-hover:scale-110 transition-transform",children:"üé´"}),(0,t.jsx)("p",{className:"font-semibold text-green-700",children:"G√©n√©rer Carte"}),(0,t.jsx)("p",{className:"text-sm text-green-600",children:"PDF avec QR Code"})]}),(0,t.jsxs)("button",{className:"bg-white border-2 border-blue-200 rounded-xl p-4 text-center hover:border-blue-300 transition-colors group",children:[(0,t.jsx)("div",{className:"text-3xl mb-2 group-hover:scale-110 transition-transform",children:"üìä"}),(0,t.jsx)("p",{className:"font-semibold text-blue-700",children:"Historique"}),(0,t.jsx)("p",{className:"text-sm text-blue-600",children:"Toutes transactions"})]})]}),(0,t.jsxs)("div",{className:"bg-gray-50 rounded-xl p-4",children:[(0,t.jsx)("h4",{className:"font-semibold text-gray-900 mb-3",children:"D√©tails du Wallet"}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsx)(f,{label:"Adresse Wallet",value:s.wallet_address}),(0,t.jsx)(f,{label:"Type",value:"Client"}),(0,t.jsx)(f,{label:"Statut",value:"Actif"}),(0,t.jsx)(f,{label:"Date de cr√©ation",value:new Date(s.created_at).toLocaleDateString()})]})]})]})}function f(e){let{label:s,value:r}=e;return(0,t.jsxs)("div",{className:"flex justify-between py-2 border-b border-gray-100 last:border-b-0",children:[(0,t.jsxs)("span",{className:"text-gray-600",children:[s,":"]}),(0,t.jsx)("span",{className:"font-medium text-gray-900",children:r})]})}function y(e){let{user:r}=e,[a,l]=(0,s.useState)([]),[n,i]=(0,s.useState)(!1),[o,c]=(0,s.useState)(null),[d,x]=(0,s.useState)(""),[m,p]=(0,s.useState)(!0);(0,s.useEffect)(()=>{g()},[]);let g=async()=>{let e=localStorage.getItem("token");try{let t=await fetch("/api/clients",{headers:{Authorization:"Bearer ".concat(e)}}),s=await t.json();l(s)}catch(e){console.error("Erreur:",e)}finally{p(!1)}},b=a.filter(e=>e.name.toLowerCase().includes(d.toLowerCase())||e.email.toLowerCase().includes(d.toLowerCase())||e.phone.includes(d)||e.wallet_address.toLowerCase().includes(d.toLowerCase())),j="admin"===r.role||"chef_operation"===r.role;return m?(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestion des Clients"}),(0,t.jsxs)("p",{className:"text-gray-600",children:[a.length," clients au total"]})]}),(0,t.jsxs)("div",{className:"flex space-x-3",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:"text",placeholder:"Rechercher un client...",value:d,onChange:e=>x(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 w-64"}),(0,t.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,t.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),j&&(0,t.jsxs)("button",{onClick:()=>i(!0),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors font-medium flex items-center space-x-2",children:[(0,t.jsx)("span",{children:"+"}),(0,t.jsx)("span",{children:"Nouveau Client"})]})]})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:b.map(e=>(0,t.jsx)(v,{client:e,onClick:()=>c(e)},e.id))}),0===b.length&&(0,t.jsxs)("div",{className:"text-center py-12 bg-white rounded-2xl border-2 border-dashed border-gray-300",children:[(0,t.jsx)("div",{className:"text-6xl mb-4",children:"üë•"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun client trouv√©"}),(0,t.jsx)("p",{className:"text-gray-500 mb-4",children:d?"Aucun client ne correspond √† votre recherche":"Commencez par ajouter votre premier client"}),j&&(0,t.jsx)("button",{onClick:()=>i(!0),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Ajouter un client"})]}),n&&(0,t.jsx)(u,{onClose:()=>i(!1),onSuccess:()=>{i(!1),g()}}),o&&(0,t.jsx)(h,{client:o,onClose:()=>c(null),onUpdate:g,user:r})]})}function v(e){let{client:s,onClick:r}=e;return(0,t.jsxs)("div",{onClick:r,className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-all cursor-pointer hover:border-blue-300",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4 mb-4",children:[s.photo?(0,t.jsx)("img",{src:s.photo,alt:s.name,className:"w-16 h-16 rounded-full object-cover"}):(0,t.jsx)("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold text-xl",children:s.name.charAt(0)}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900 truncate",children:s.name}),(0,t.jsx)("p",{className:"text-sm text-gray-500 truncate",children:s.email})]})]}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"T√©l√©phone:"}),(0,t.jsx)("span",{className:"font-medium",children:s.phone})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"Wallet:"}),(0,t.jsxs)("span",{className:"font-mono text-xs bg-gray-100 px-2 py-1 rounded",children:[s.wallet_address.slice(0,8),"..."]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"CIN:"}),(0,t.jsx)("span",{className:"font-medium",children:s.cin})]})]}),(0,t.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-100",children:(0,t.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"Inscrit le:"}),(0,t.jsx)("span",{className:"text-gray-600",children:new Date(s.created_at).toLocaleDateString()})]})})]})}function N(e){let{user:r}=e,[a,l]=(0,s.useState)([]),[n,i]=(0,s.useState)(!1),[o,c]=(0,s.useState)(null);(0,s.useEffect)(()=>{d()},[]);let d=async()=>{let e=localStorage.getItem("token");try{let t=await fetch("/api/users",{headers:{Authorization:"Bearer ".concat(e)}}),s=await t.json();l(s)}catch(e){console.error("Erreur:",e)}},x=async e=>{if(!confirm("√ätes-vous s√ªr de vouloir supprimer cet utilisateur ?"))return;let t=localStorage.getItem("token");try{(await fetch("/api/users/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})).ok&&(d(),alert("Utilisateur supprim√© avec succ√®s"))}catch(e){console.error("Erreur:",e)}};return(0,t.jsxs)("div",{className:"px-4 py-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold",children:"Gestion des Utilisateurs"}),(0,t.jsx)("button",{onClick:()=>i(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:"Ajouter Utilisateur"})]}),n&&(0,t.jsx)(w,{user:o,onClose:()=>{i(!1),c(null)},onSuccess:d}),(0,t.jsx)("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Nom"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Email"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"R√¥le"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"T√©l√©phone"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date cr√©ation"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsxs)("div",{className:"flex items-center",children:[e.photo&&(0,t.jsx)("img",{className:"h-10 w-10 rounded-full mr-3",src:e.photo,alt:""}),(0,t.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name})]})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.email}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat("admin"===e.role?"bg-purple-100 text-purple-800":"chef_operation"===e.role?"bg-blue-100 text-blue-800":"caissier"===e.role?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.role})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.phone||"-"}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString()}),(0,t.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[(0,t.jsx)("button",{onClick:()=>{c(e),i(!0)},className:"text-blue-600 hover:text-blue-900 mr-3",children:"Modifier"}),e.id!==r.id&&(0,t.jsx)("button",{onClick:()=>x(e.id),className:"text-red-600 hover:text-red-900",children:"Supprimer"})]})]},e.id))})]})})]})}function w(e){let{user:r,onClose:a,onSuccess:l}=e,[n,i]=(0,s.useState)({name:"",email:"",password:"",role:"caissier",phone:""}),[o,c]=(0,s.useState)(!1);(0,s.useEffect)(()=>{r&&(i({name:r.name,email:r.email,password:"",role:r.role,phone:r.phone||""}),c(!0))},[r]);let d=async e=>{e.preventDefault();let t=localStorage.getItem("token"),s=o?"/api/users/".concat(r.id):"/api/users",i={...n};i.password||delete i.password;try{let e=await fetch(s,{method:o?"PUT":"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(i)});if(e.ok)l(),a();else{let t=await e.json();alert(t.error)}}catch(e){console.error("Erreur:",e),alert("Erreur lors de la cr√©ation de l'utilisateur")}};return(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,t.jsx)("h3",{className:"text-lg font-bold mb-4",children:o?"Modifier Utilisateur":"Nouvel Utilisateur"}),(0,t.jsxs)("form",{onSubmit:d,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Nom complet"}),(0,t.jsx)("input",{type:"text",value:n.name,onChange:e=>i({...n,name:e.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,t.jsx)("input",{type:"email",value:n.email,onChange:e=>i({...n,email:e.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:o?"Nouveau mot de passe (laisser vide pour ne pas changer)":"Mot de passe"}),(0,t.jsx)("input",{type:"password",value:n.password,onChange:e=>i({...n,password:e.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md",required:!o})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"R√¥le"}),(0,t.jsxs)("select",{value:n.role,onChange:e=>i({...n,role:e.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,t.jsx)("option",{value:"caissier",children:"Caissier"}),(0,t.jsx)("option",{value:"agent",children:"Agent"}),(0,t.jsx)("option",{value:"chef_operation",children:"Chef d'Op√©ration"}),(0,t.jsx)("option",{value:"admin",children:"Administrateur"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"T√©l√©phone"}),(0,t.jsx)("input",{type:"tel",value:n.phone,onChange:e=>i({...n,phone:e.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,t.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Annuler"}),(0,t.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:o?"Modifier":"Cr√©er"})]})]})]})})}function C(e){let{user:r}=e,[a,l]=(0,s.useState)("visa"),[n,i]=(0,s.useState)([]),[o,c]=(0,s.useState)(""),[d,x]=(0,s.useState)({start:"",end:""}),[m,u]=(0,s.useState)("transactions"),[h,p]=(0,s.useState)(!1);(0,s.useEffect)(()=>{g()},[]);let g=async()=>{let e=localStorage.getItem("token");try{let t=await fetch("/api/clients",{headers:{Authorization:"Bearer ".concat(e)}}),s=await t.json();i(s)}catch(e){console.error("Erreur:",e)}},b=async()=>{if(!o)return void alert("Veuillez s√©lectionner un client");p(!0);let e=localStorage.getItem("token");try{let t=await fetch("/api/generate-card/".concat(o),{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.blob(),s=window.URL.createObjectURL(e),r=document.createElement("a");r.href=s,r.download="carte_visa_".concat(o,".pdf"),document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(s),alert("Carte Visa g√©n√©r√©e avec succ√®s!")}}catch(e){console.error("Erreur:",e),alert("Erreur lors de la g√©n√©ration de la carte")}finally{p(!1)}},j=async()=>{if(!d.start||!d.end)return void alert("Veuillez s√©lectionner une p√©riode");p(!0);let e=localStorage.getItem("token");try{let t=await fetch("/api/generate-report",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({type:m,startDate:d.start,endDate:d.end})});if(t.ok){let e=await t.blob(),s=window.URL.createObjectURL(e),r=document.createElement("a");r.href=s,r.download="rapport_".concat(m,"_").concat(d.start,"_").concat(d.end,".pdf"),document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(s),alert("Rapport g√©n√©r√© avec succ√®s!")}}catch(e){console.error("Erreur:",e),alert("Erreur lors de la g√©n√©ration du rapport")}finally{p(!1)}},f=async()=>{if(!o)return void alert("Veuillez s√©lectionner un client");p(!0);let e=localStorage.getItem("token");try{let s=await fetch("/api/generate-statement/".concat(o),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({startDate:d.start,endDate:d.end})});if(s.ok){var t;let e=await s.blob(),r=window.URL.createObjectURL(e),a=document.createElement("a");a.href=r;let l=(null==(t=n.find(e=>e.id==o))?void 0:t.name)||"client";a.download="releve_".concat(l,"_").concat(d.start,"_").concat(d.end,".pdf"),document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(r),alert("Relev√© g√©n√©r√© avec succ√®s!")}}catch(e){console.error("Erreur:",e),alert("Erreur lors de la g√©n√©ration du relev√©")}finally{p(!1)}};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"G√©n√©ration de Documents"}),(0,t.jsx)("p",{className:"text-gray-600",children:"G√©n√©rez des cartes Visa, rapports et relev√©s clients"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200",children:[(0,t.jsx)("div",{className:"border-b border-gray-200",children:(0,t.jsx)("nav",{className:"flex space-x-8 px-6",children:[{id:"visa",label:"Cartes Visa",icon:"üé´"},{id:"reports",label:"Rapports",icon:"üìä"},{id:"statements",label:"Relev√©s Clients",icon:"üìÑ"},{id:"contracts",label:"Contrats",icon:"üìù"}].map(e=>(0,t.jsxs)("button",{onClick:()=>l(e.id),className:"py-4 px-1 border-b-2 font-medium text-sm transition-colors flex items-center space-x-2 ".concat(a===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"),children:[(0,t.jsx)("span",{children:e.icon}),(0,t.jsx)("span",{children:e.label})]},e.id))})}),(0,t.jsxs)("div",{className:"p-6",children:["visa"===a&&(0,t.jsx)(k,{clients:n,selectedClient:o,setSelectedClient:c,onGenerate:b,loading:h}),"reports"===a&&(0,t.jsx)(S,{dateRange:d,setDateRange:x,reportType:m,setReportType:u,onGenerate:j,loading:h}),"statements"===a&&(0,t.jsx)(_,{clients:n,selectedClient:o,setSelectedClient:c,dateRange:d,setDateRange:x,onGenerate:f,loading:h}),"contracts"===a&&(0,t.jsx)(A,{clients:n,selectedClient:o,setSelectedClient:c,loading:h})]})]})]})}function k(e){var s,r;let{clients:a,selectedClient:l,setSelectedClient:n,onGenerate:i,loading:o}=e;return(0,t.jsx)("div",{className:"space-y-6",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"G√©n√©ration de Carte Visa"}),(0,t.jsx)("p",{className:"text-gray-600 mb-6",children:"G√©n√©rez une carte Visa personnalis√©e pour vos clients avec QR code et num√©ro de compte."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"S√©lectionner un Client *"}),(0,t.jsxs)("select",{value:l,onChange:e=>n(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,t.jsx)("option",{value:"",children:"Choisir un client..."}),a.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.name," - ",e.wallet_address]},e.id))]})]}),(0,t.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[(0,t.jsx)("h4",{className:"font-semibold text-blue-900 mb-2",children:"Informations"}),(0,t.jsxs)("ul",{className:"text-sm text-blue-700 space-y-1",children:[(0,t.jsx)("li",{children:"‚Ä¢ Carte Visa personnalis√©e avec logo ADOUAS-MC"}),(0,t.jsx)("li",{children:"‚Ä¢ QR code contenant les informations du client"}),(0,t.jsx)("li",{children:"‚Ä¢ Num√©ro de compte et solde actuel"}),(0,t.jsx)("li",{children:"‚Ä¢ Design professionnel et s√©curis√©"})]})]}),(0,t.jsx)("button",{onClick:i,disabled:!l||o,className:"w-full bg-green-600 text-white py-3 px-6 rounded-lg hover:bg-green-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:o?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,t.jsx)("span",{children:"G√©n√©ration en cours..."})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{children:"üé´"}),(0,t.jsx)("span",{children:"G√©n√©rer la Carte Visa"})]})})]}),(0,t.jsxs)("div",{className:"bg-gradient-to-br from-blue-600 to-purple-700 rounded-2xl p-6 text-white relative overflow-hidden",children:[(0,t.jsxs)("div",{className:"relative z-10",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-blue-200 text-sm font-medium mb-1",children:"ADOUAS-MC VISA"}),(0,t.jsx)("div",{className:"text-2xl font-bold",children:"Micro Cr√©dit Card"})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-blue-200 text-sm",children:"Valide jusqu'au"}),(0,t.jsx)("div",{className:"text-lg font-semibold",children:"12/25"})]})]}),(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("div",{className:"text-blue-200 text-sm mb-2",children:"Titulaire de la carte"}),(0,t.jsx)("div",{className:"text-xl font-bold uppercase",children:l&&(null==(s=a.find(e=>e.id==l))?void 0:s.name.toUpperCase())||"NOM DU CLIENT"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-end",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-blue-200 text-sm mb-2",children:"Num√©ro de compte"}),(0,t.jsx)("div",{className:"font-mono text-lg tracking-wider",children:l&&(null==(r=a.find(e=>e.id==l))?void 0:r.wallet_address.slice(0,16))||"XXXX XXXX XXXX XXXX"})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-blue-200 text-sm mb-2",children:"QR Code"}),(0,t.jsx)("div",{className:"w-16 h-16 bg-white/20 rounded-lg flex items-center justify-center",children:(0,t.jsx)("div",{className:"text-2xl",children:"QR"})})]})]})]}),(0,t.jsx)("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -translate-y-16 translate-x-16"}),(0,t.jsx)("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-white/10 rounded-full translate-y-12 -translate-x-12"})]})]})})}function S(e){var s;let{dateRange:r,setDateRange:a,reportType:l,setReportType:n,onGenerate:i,loading:o}=e,c=[{id:"transactions",label:"Rapport des Transactions",icon:"üîÑ",description:"Toutes les transactions sur la p√©riode"},{id:"loans",label:"Rapport des Pr√™ts",icon:"üí∞",description:"√âtat des pr√™ts et remboursements"},{id:"clients",label:"Rapport des Clients",icon:"üë•",description:"Liste et statistiques clients"},{id:"financial",label:"Rapport Financier",icon:"üìà",description:"Bilan financier complet"}];return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"G√©n√©ration de Rapports"}),(0,t.jsx)("p",{className:"text-gray-600",children:"G√©n√©rez des rapports d√©taill√©s pour analyser l'activit√© de votre agence."})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Type de Rapport *"}),(0,t.jsx)("div",{className:"grid grid-cols-1 gap-3",children:c.map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>n(e.id),className:"p-4 rounded-xl border-2 text-left transition-all ".concat(l===e.id?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-gray-300 text-gray-600"),children:(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"text-2xl",children:e.icon}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-semibold",children:e.label}),(0,t.jsx)("div",{className:"text-sm opacity-75",children:e.description})]})]})},e.id))})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date de d√©but *"}),(0,t.jsx)("input",{type:"date",value:r.start,onChange:e=>a({...r,start:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date de fin *"}),(0,t.jsx)("input",{type:"date",value:r.end,onChange:e=>a({...r,end:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),(0,t.jsx)("button",{onClick:i,disabled:!r.start||!r.end||o,className:"w-full bg-blue-600 text-white py-3 px-6 rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:o?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,t.jsx)("span",{children:"G√©n√©ration du rapport..."})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{children:"üìä"}),(0,t.jsx)("span",{children:"G√©n√©rer le Rapport"})]})})]}),(0,t.jsxs)("div",{className:"bg-gray-50 rounded-2xl p-6 border-2 border-dashed border-gray-300",children:[(0,t.jsx)("h4",{className:"font-semibold text-gray-900 mb-4",children:"Aper√ßu du Rapport"}),(0,t.jsxs)("div",{className:"space-y-4 text-sm text-gray-600",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Type:"}),(0,t.jsx)("span",{className:"font-medium capitalize",children:null==(s=c.find(e=>e.id===l))?void 0:s.label})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"P√©riode:"}),(0,t.jsxs)("span",{className:"font-medium",children:[r.start?new Date(r.start).toLocaleDateString():"--"," au ",r.end?new Date(r.end).toLocaleDateString():"--"]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Format:"}),(0,t.jsx)("span",{className:"font-medium",children:"PDF Professionnel"})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Contenu:"}),(0,t.jsxs)("span",{className:"font-medium text-right",children:["transactions"===l&&"Liste d√©taill√©e des transactions\nGraphiques et statistiques","loans"===l&&"√âtat des pr√™ts actifs\nHistorique des remboursements","clients"===l&&"Liste compl√®te des clients\nStatistiques par segment","financial"===l&&"Bilan financier\nTableaux de bord d√©taill√©s"]})]})]}),(0,t.jsx)("div",{className:"mt-6 p-4 bg-white rounded-lg border border-gray-200",children:(0,t.jsxs)("div",{className:"text-xs text-gray-500 space-y-1",children:[(0,t.jsx)("div",{children:"üìã En-t√™te avec logo ADOUAS-MC"}),(0,t.jsx)("div",{children:"üìä Tableaux et graphiques"}),(0,t.jsx)("div",{children:"üî¢ Chiffres et statistiques"}),(0,t.jsx)("div",{children:"üìÖ P√©riode couverte"}),(0,t.jsx)("div",{children:"üë§ Informations de l'agence"})]})})]})]})]})}function _(e){var s,r;let{clients:a,selectedClient:l,setSelectedClient:n,dateRange:i,setDateRange:o,onGenerate:c,loading:d}=e;return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Relev√©s Clients"}),(0,t.jsx)("p",{className:"text-gray-600",children:"G√©n√©rez des relev√©s d√©taill√©s pour vos clients avec leur historique de transactions."})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"S√©lectionner un Client *"}),(0,t.jsxs)("select",{value:l,onChange:e=>n(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,t.jsx)("option",{value:"",children:"Choisir un client..."}),a.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.name," - ",e.wallet_address]},e.id))]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date de d√©but"}),(0,t.jsx)("input",{type:"date",value:i.start,onChange:e=>o({...i,start:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date de fin"}),(0,t.jsx)("input",{type:"date",value:i.end,onChange:e=>o({...i,end:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),(0,t.jsxs)("div",{className:"bg-green-50 rounded-lg p-4 border border-green-200",children:[(0,t.jsx)("h4",{className:"font-semibold text-green-900 mb-2",children:"Contenu du Relev√©"}),(0,t.jsxs)("ul",{className:"text-sm text-green-700 space-y-1",children:[(0,t.jsx)("li",{children:"‚Ä¢ Informations client compl√®tes"}),(0,t.jsx)("li",{children:"‚Ä¢ Solde actuel du wallet"}),(0,t.jsx)("li",{children:"‚Ä¢ Historique des transactions"}),(0,t.jsx)("li",{children:"‚Ä¢ D√©tails des pr√™ts et remboursements"}),(0,t.jsx)("li",{children:"‚Ä¢ Signature et cachet de l'agence"})]})]}),(0,t.jsx)("button",{onClick:c,disabled:!l||d,className:"w-full bg-purple-600 text-white py-3 px-6 rounded-lg hover:bg-purple-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:d?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,t.jsx)("span",{children:"G√©n√©ration en cours..."})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{children:"üìÑ"}),(0,t.jsx)("span",{children:"G√©n√©rer le Relev√©"})]})})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl p-6 border-2 border-gray-200 shadow-sm",children:[(0,t.jsxs)("div",{className:"text-center mb-6",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:"ADOUAS-MC"}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Relev√© de Compte Client"})]}),l?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"border-b border-gray-200 pb-4",children:[(0,t.jsx)("div",{className:"font-semibold text-gray-900",children:null==(s=a.find(e=>e.id==l))?void 0:s.name}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:null==(r=a.find(e=>e.id==l))?void 0:r.wallet_address})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-gray-500",children:"P√©riode"}),(0,t.jsxs)("div",{className:"font-medium",children:[i.start?new Date(i.start).toLocaleDateString():"D√©but"," -",i.end?new Date(i.end).toLocaleDateString():"Aujourd'hui"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-gray-500",children:"Date d'√©mission"}),(0,t.jsx)("div",{className:"font-medium",children:new Date().toLocaleDateString()})]})]}),(0,t.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,t.jsx)("div",{className:"text-center text-sm text-gray-600",children:"Historique des transactions et solde actuel"})}),(0,t.jsx)("div",{className:"border-t border-gray-200 pt-4 text-xs text-gray-500 text-center",children:"Document officiel ADOUAS-MC - Micro Cr√©dit"})]}):(0,t.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,t.jsx)("div",{className:"text-4xl mb-2",children:"üìÑ"}),(0,t.jsx)("p",{children:"S√©lectionnez un client pour voir l'aper√ßu"})]})]})]})]})}function A(e){let{clients:s,selectedClient:r,setSelectedClient:a,loading:l}=e,n=async e=>{if(!r)return void alert("Veuillez s√©lectionner un client");let t=localStorage.getItem("token");try{let l=await fetch("/api/generate-contract/".concat(r),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({type:e})});if(l.ok){var a;let t=await l.blob(),n=window.URL.createObjectURL(t),i=document.createElement("a");i.href=n;let o=(null==(a=s.find(e=>e.id==r))?void 0:a.name)||"client";i.download="contrat_".concat(e,"_").concat(o,".pdf"),document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(n),alert("Contrat g√©n√©r√© avec succ√®s!")}}catch(e){console.error("Erreur:",e),alert("Erreur lors de la g√©n√©ration du contrat")}};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"G√©n√©ration de Documents"}),(0,t.jsx)("p",{className:"text-gray-600",children:"G√©n√©rez des cartes Visa, rapports et relev√©s clients"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"S√©lectionner un Client *"}),(0,t.jsxs)("select",{value:r,onChange:e=>a(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,t.jsx)("option",{value:"",children:"Choisir un client..."}),s.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.name," - ",e.wallet_address]},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Type de Document *"}),(0,t.jsx)("div",{className:"space-y-3",children:[{id:"pret",label:"Contrat de Pr√™t",icon:"üí∞",description:"Contrat standard pour octroi de pr√™t",color:"blue"},{id:"renouvellement",label:"Avenant de Renouvellement",icon:"üîÑ",description:"Pour renouvellement de pr√™t existant",color:"green"},{id:"echeancier",label:"√âch√©ancier de Paiement",icon:"üìÖ",description:"Calendrier de remboursement d√©taill√©",color:"purple"}].map(e=>(0,t.jsx)("button",{onClick:()=>n(e.id),disabled:!r||l,className:"w-full p-4 rounded-xl border-2 text-left transition-all disabled:opacity-50 disabled:cursor-not-allowed ".concat("blue"===e.color?"border-blue-200 hover:border-blue-300":"green"===e.color?"border-green-200 hover:border-green-300":"border-purple-200 hover:border-purple-300"),children:(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"text-2xl",children:e.icon}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"font-semibold text-gray-900",children:e.label}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:e.description})]}),(0,t.jsx)("div",{className:"text-gray-400",children:(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})]})},e.id))})]})]}),(0,t.jsxs)("div",{className:"bg-yellow-50 rounded-2xl p-6 border-2 border-yellow-200",children:[(0,t.jsx)("h4",{className:"font-semibold text-yellow-900 mb-4",children:"Informations L√©gales"}),(0,t.jsxs)("div",{className:"space-y-3 text-sm text-yellow-800",children:[(0,t.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,t.jsx)("span",{children:"‚öñÔ∏è"}),(0,t.jsx)("span",{children:"Tous les contrats sont conformes √† la r√©glementation des micro-cr√©dits"})]}),(0,t.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,t.jsx)("span",{children:"üìã"}),(0,t.jsx)("span",{children:"Incluent les clauses l√©gales obligatoires"})]}),(0,t.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,t.jsx)("span",{children:"üîí"}),(0,t.jsx)("span",{children:"Protection des donn√©es client conform√©ment √† la loi"})]}),(0,t.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,t.jsx)("span",{children:"üìû"}),(0,t.jsx)("span",{children:"Service client et m√©diation inclus"})]})]}),(0,t.jsx)("div",{className:"mt-6 p-4 bg-white rounded-lg border border-yellow-300",children:(0,t.jsxs)("div",{className:"text-xs text-yellow-700",children:[(0,t.jsx)("strong",{children:"Important:"})," Tous les documents g√©n√©r√©s portent le cachet officiel d'ADOUAS-MC et sont des documents l√©gaux opposables."]})})]})]})]})}function L(){let[e,i]=(0,s.useState)(null),[o,d]=(0,s.useState)("overview"),[x,m]=(0,s.useState)(!1),[u,h]=(0,s.useState)(!0),p=(0,r.useRouter)();return((0,s.useEffect)(()=>{let e=localStorage.getItem("token"),t=localStorage.getItem("user");if(!e||!t)return void p.push("/");i(JSON.parse(t)),h(!1)},[p]),u)?(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto"}),(0,t.jsx)("p",{className:"mt-4 text-gray-600",children:"Chargement..."})]})}):e?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(a.default,{children:[(0,t.jsx)("title",{children:"ADOUAS-MC - Dashboard"}),(0,t.jsx)("meta",{name:"description",content:"Syst√®me de gestion de micro-cr√©dit"})]}),(0,t.jsxs)("div",{className:"flex h-screen bg-gray-50",children:[(0,t.jsx)(l,{activeTab:o,setActiveTab:d,sidebarOpen:x,setSidebarOpen:m,user:e}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,t.jsx)(n,{user:e,onLogout:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),p.push("/")},onMenuClick:()=>m(!x)}),(0,t.jsx)("main",{className:"flex-1 overflow-y-auto p-4 md:p-6",children:(()=>{switch(o){case"overview":default:return(0,t.jsx)(T,{user:e});case"clients":return(0,t.jsx)(y,{user:e});case"transactions":return(0,t.jsx)(D,{user:e});case"loans":return(0,t.jsx)(c,{user:e});case"users":return(0,t.jsx)(N,{user:e});case"documents":return(0,t.jsx)(C,{user:e})}})()})]})]})]}):null}function T(e){let{user:r}=e,[a,l]=(0,s.useState)({totalBalance:0,pendingTransactions:0,activeLoans:0,totalClients:0,todayTransactions:0,monthlyRevenue:0}),[n,c]=(0,s.useState)([]),[d,x]=(0,s.useState)(!0);(0,s.useEffect)(()=>{m()},[]);let m=async()=>{let e=localStorage.getItem("token");try{let t=await fetch("/api/dashboard/stats",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json(),s={totalBalance:Number(e.totalBalance)||0,pendingTransactions:Number(e.pendingTransactions)||0,activeLoans:Number(e.activeLoans)||0,totalClients:Number(e.totalClients)||0,todayTransactions:Number(e.todayTransactions)||0,monthlyRevenue:Number(e.monthlyRevenue)||0};l(s)}let s=await fetch("/api/transactions?limit=5",{headers:{Authorization:"Bearer ".concat(e)}});if(s.ok){let e=await s.json();c(Array.isArray(e)?e:[])}}catch(e){console.error("Erreur:",e)}finally{x(!1)}};return d?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-purple-700 rounded-2xl p-6 text-white animate-pulse",children:[(0,t.jsx)("div",{className:"h-8 bg-blue-500 rounded w-1/3 mb-2"}),(0,t.jsx)("div",{className:"h-4 bg-blue-400 rounded w-1/2"})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[1,2,3,4].map(e=>(0,t.jsxs)("div",{className:"bg-gray-100 rounded-2xl p-6 animate-pulse",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-300 rounded w-3/4 mb-2"}),(0,t.jsx)("div",{className:"h-6 bg-gray-300 rounded w-1/2"})]},e))})]}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-purple-700 rounded-2xl p-6 text-white",children:[(0,t.jsxs)("h1",{className:"text-3xl font-bold mb-2",children:["Bienvenue, ",r.name," üëã"]}),(0,t.jsx)("p",{className:"text-blue-100",children:"G√©rez votre agence de micro-cr√©dit efficacement"}),(0,t.jsxs)("div",{className:"flex items-center mt-4 space-x-2",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),(0,t.jsx)("span",{className:"text-sm",children:"Syst√®me en ligne"})]})]}),(0,t.jsx)(i,{stats:a}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:"Transactions R√©centes"}),(0,t.jsx)("button",{onClick:()=>window.dispatchEvent(new CustomEvent("tabChange",{detail:"transactions"})),className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:"Voir tout"})]}),(0,t.jsx)(o,{transactions:n})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-6",children:"Actions Rapides"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsx)(E,{icon:"üí∞",title:"Nouvelle Transaction",description:"Effectuer un transfert",onClick:()=>window.dispatchEvent(new CustomEvent("openTransactionForm")),color:"blue"}),(0,t.jsx)(E,{icon:"üë•",title:"Ajouter Client",description:"Cr√©er un nouveau client",onClick:()=>window.dispatchEvent(new CustomEvent("tabChange",{detail:"clients"})),color:"green"}),(0,t.jsx)(E,{icon:"üìä",title:"G√©rer Pr√™ts",description:"Voir les pr√™ts actifs",onClick:()=>window.dispatchEvent(new CustomEvent("tabChange",{detail:"loans"})),color:"purple"}),(0,t.jsx)(E,{icon:"üé´",title:"G√©n√©rer Carte",description:"Cr√©er carte Visa",onClick:()=>window.dispatchEvent(new CustomEvent("tabChange",{detail:"documents"})),color:"orange"})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"lg:col-span-2 bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Activit√© Mensuelle"}),(0,t.jsx)("div",{className:"h-64 flex items-center justify-center text-gray-400",children:"Graphique des transactions (√† impl√©menter)"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Top Clients"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(O,{name:"Moussa Diop",amount:"750,000 XOF"}),(0,t.jsx)(O,{name:"Aminata Sow",amount:"620,000 XOF"}),(0,t.jsx)(O,{name:"Ibrahima Fall",amount:"580,000 XOF"}),(0,t.jsx)(O,{name:"Fatou B√¢",amount:"450,000 XOF"}),(0,t.jsx)(O,{name:"Jean Kamga",amount:"390,000 XOF"})]})]})]})]})}function D(e){let{user:r}=e,[a,l]=(0,s.useState)([]),[n,i]=(0,s.useState)(!1),[o,c]=(0,s.useState)({status:"",type:"",date:""});(0,s.useEffect)(()=>{d()},[o]);let d=async()=>{let e=localStorage.getItem("token"),t=new URLSearchParams;Object.entries(o).forEach(e=>{let[s,r]=e;r&&t.append(s,r)});try{let s=await fetch("/api/transactions?".concat(t),{headers:{Authorization:"Bearer ".concat(e)}}),r=await s.json();l(r)}catch(e){console.error("Erreur:",e)}};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestion des Transactions"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Suivez et g√©rez toutes les transactions"})]}),(0,t.jsxs)("button",{onClick:()=>i(!0),className:"bg-blue-600 text-white px-6 py-3 rounded-xl hover:bg-blue-700 transition-colors font-medium flex items-center space-x-2",children:[(0,t.jsx)("span",{children:"+"}),(0,t.jsx)("span",{children:"Nouvelle Transaction"})]})]}),(0,t.jsx)("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Statut"}),(0,t.jsxs)("select",{value:o.status,onChange:e=>c({...o,status:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,t.jsx)("option",{value:"",children:"Tous les statuts"}),(0,t.jsx)("option",{value:"pending",children:"En attente"}),(0,t.jsx)("option",{value:"completed",children:"Compl√©t√©es"}),(0,t.jsx)("option",{value:"cancelled",children:"Annul√©es"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type"}),(0,t.jsxs)("select",{value:o.type,onChange:e=>c({...o,type:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,t.jsx)("option",{value:"",children:"Tous les types"}),(0,t.jsx)("option",{value:"transfert",children:"Transfert"}),(0,t.jsx)("option",{value:"pret",children:"Pr√™t"}),(0,t.jsx)("option",{value:"remboursement",children:"Remboursement"}),(0,t.jsx)("option",{value:"depot",children:"D√©p√¥t"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date"}),(0,t.jsx)("input",{type:"date",value:o.date,onChange:e=>c({...o,date:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,t.jsx)("div",{className:"flex items-end",children:(0,t.jsx)("button",{onClick:()=>c({status:"",type:"",date:""}),className:"w-full px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"R√©initialiser"})})]})}),(0,t.jsx)("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),(0,t.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"De"}),(0,t.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Vers"}),(0,t.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Montant"}),(0,t.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),(0,t.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),(0,t.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,t.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(e=>(0,t.jsx)(R,{transaction:e,user:r,onValidate:d},e.id))})]})})}),n&&(0,t.jsx)(m,{onClose:()=>i(!1),onSuccess:()=>{i(!1),d()}})]})}function E(e){let{icon:s,title:r,description:a,onClick:l,color:n}=e;return(0,t.jsxs)("button",{onClick:l,className:"p-4 rounded-xl border-2 transition-all duration-200 text-left ".concat({blue:"bg-blue-50 text-blue-600 hover:bg-blue-100 border-blue-200",green:"bg-green-50 text-green-600 hover:bg-green-100 border-green-200",purple:"bg-purple-50 text-purple-600 hover:bg-purple-100 border-purple-200",orange:"bg-orange-50 text-orange-600 hover:bg-orange-100 border-orange-200"}[n]),children:[(0,t.jsx)("div",{className:"text-2xl mb-2",children:s}),(0,t.jsx)("h3",{className:"font-semibold mb-1",children:r}),(0,t.jsx)("p",{className:"text-sm opacity-75",children:a})]})}function O(e){let{name:s,amount:r}=e;return(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 hover:bg-gray-50 rounded-lg transition-colors",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white text-sm font-bold",children:s.charAt(0)}),(0,t.jsx)("span",{className:"font-medium text-gray-700",children:s})]}),(0,t.jsx)("span",{className:"font-semibold text-green-600",children:r})]})}function R(e){let{transaction:s,user:r,onValidate:a}=e,l=async()=>{let e=localStorage.getItem("token");try{(await fetch("/api/transactions/".concat(s.id,"/validate"),{method:"POST",headers:{Authorization:"Bearer ".concat(e)}})).ok&&a()}catch(e){console.error("Erreur:",e)}};return(0,t.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[(0,t.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:["#",s.id]}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("span",{className:"text-lg",children:{transfert:"üîÑ",pret:"üí∞",remboursement:"üì•",depot:"üí≥"}[s.type]||"‚ö°"}),(0,t.jsx)("span",{className:"font-mono text-xs",children:s.from_wallet})]})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 font-mono",children:s.to_wallet}),(0,t.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900",children:[parseFloat(s.amount).toLocaleString()," XOF"]}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 capitalize",children:s.type}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(e=>{let s={pending:{color:"bg-yellow-100 text-yellow-800",label:"En attente"},completed:{color:"bg-green-100 text-green-800",label:"Compl√©t√©e"},cancelled:{color:"bg-red-100 text-red-800",label:"Annul√©e"}},r=s[e]||s.pending;return(0,t.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat(r.color),children:r.label})})(s.status)}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(s.created_at).toLocaleDateString()}),(0,t.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[("admin"===r.role||"chef_operation"===r.role)&&"pending"===s.status&&(0,t.jsx)("button",{onClick:l,className:"text-green-600 hover:text-green-900 font-medium",children:"Valider"}),(0,t.jsx)("button",{className:"text-blue-600 hover:text-blue-900 font-medium ml-3",children:"D√©tails"})]})]})}},35846,(e,t,s)=>{let r="/dashboard";(window.__NEXT_P=window.__NEXT_P||[]).push([r,()=>e.r(72973)]),t.hot&&t.hot.dispose(function(){window.__NEXT_P.push([r])})}]);